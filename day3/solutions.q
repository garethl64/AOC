f:{sum 1+raze[.Q`a`A]?first each x};
g:{.'[inter;cut'[0,/:"j"$%[;2]count each x;x]]};
h:(inter/')3 cut;
i:{f each(g;h)@\:read0`:input3.txt};
/
q)i[]
8298 2708
q)\ts i[]
0 74448
\
